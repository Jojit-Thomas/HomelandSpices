<link rel="stylesheet" href="/stylesheets/user/cart.css" />
<link rel="stylesheet" href="/stylesheets/button.css" />
{{!-- <span class="kart">Shoping Cart</span>
{{#each data}}
<div class="border border-dark m-5">
  <p>{{this.cartItems.quantity}}</p>
  <p>{{this.product._id}}</p>  
  <p>{{this.product.name}}</p>
  <p>{{this.product.description}}</p>
  <p>{{this.product.price}}</p>
  <p>{{this.product.category }}</p>
  <h1>{{this.product.quantity}}</h1>
  <button type="button" id="{{this.product._id}}{{this._id}}" onclick='changeQuantity("{{this._id}}","{{this.product._id}}","{{this.userId}}","-1")'>-</button>
  <span id="{{this.product._id}}">{{this.cartItems.quantity}}</span>
  <button type="button" onclick='changeQuantity("{{this._id}}","{{this.product._id}}","{{this.userId}}","1")' >+</button>
  <button type="button" onclick='removeFromCart("{{this._id}}","{{this.product._id}}")' >Remove</button>
  
</div>
{{/each}}
<h1>Total Amount is : <span id="total" >{{total}}</span></h1> --}}

{{!-- 
<div class="container-fluid">
  <div class="row">
    <div class="carts col-12 col-sm-8 p-5">
      {{#each data}}
        {{! <div class="card border border-0 col-12"> }}
        <div class="card- d-flex col-12">
          <div class="col-12 col-sm-2 d-flex justify-content-center">
            <img
              src="/product_images/{{this.product._id}}.{{this.product.img_ext}}"
              class="imgCrop m-auto"
              width="50px"
              height="auto"
              class="card-img-bottom"
              alt="..."
            />
          </div>
          <div class="col-12 col-sm-10 px-3">
            <h5 class="card-title">{{this.product.title}}</h5>
            <p class="card-text">{{this.product.desc}}</p>
            <p class="card-text"><small
                class="text-muted"
              >{{this.product.price}}</small></p>
            <div class="d-flex">
              <button
                class="input-number-decrement"
                id="{{this.product._id}}{{this._id}}"
                onclick='changeQuantity("{{this._id}}","{{this.product._id}}","{{this.userId}}","-1")'
              >–</button><input
                class="input-number"
                id="{{this.product._id}}"
                type="text"
                value="{{this.cartItems.quantity}}"
                min="0"
                max="10"
              />
              <button
                class="input-number-increment"
                onclick='changeQuantity("{{this._id}}","{{this.product._id}}","{{this.userId}}","1")'
              >+</button>
              <button
                class="text-center px-5 align-items-end d-flex text-danger btn-none"
                onclick="removeFromCart('{{this._id}}','{{this.product._id}}')"
              >Remove</button>
            </div>
          </div>
          {{! </div> }}
        </div>
      {{/each}}
    </div>
    <div class="col-12 col-sm-4 p-0"></div>
  </div>
</div> --}}

<div class="container-fluid h-100">
  <div class="row d-flex justify-content-center align-items-center h-100">
    <div class="col-12">
      <div class="card border border-0">
        <div class="card-body p-0">
          <div class="row g-0">
            <div class="col-lg-9 col-sm-12 col-12 py-3 px-5">
              <div class="p-5">
                <div
                  class="d-flex justify-content-between align-items-center mb-5"
                >
                  <h1 class="fw-bold mb-0 text-black">Cart</h1>
                  <h6 class="mb-0 text-muted">{{data.length}} items</h6>
                </div>

                <hr class="my-4" />
                {{#each data}}
                  <div
                    class="row mb-4 g-0 d-flex justify-content-between align-items-center"
                  >
                    <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3 ">
                      <img
                        src="/product_images/{{this.product._id}}.{{this.product.img_ext}}"
                        class="imgCrop m-auto ms-4"
                        width="50px"
                        height="auto"
                        class="card-img-bottom"
                        alt="..."
                      />
                    </div>
                    <div class="col-sm-4 col-md-4 col-lg-4 col-xl-3 ">
                      <h5 class="text-muted">{{this.product.title}}</h5>
                      <p class="text-black mb-0">{{this.product.desc}}</p>
                      <div class="d-flex my-4">
                        <button
                          class="input-number-decrement"
                          id="{{this.product._id}}{{this._id}}"
                          onclick='changeQuantity("{{this._id}}","{{this.product._id}}","{{this.userId}}","-1")'
                        >–</button><input
                          class="input-number"
                          id="{{this.product._id}}"
                          type="text"
                          value="{{this.cartItems.quantity}}"
                          min="0"
                          disabled
                        />
                        <button
                          class="input-number-increment"
                          onclick='changeQuantity("{{this._id}}","{{this.product._id}}","{{this.userId}}","1")'
                        >+</button>
                      </div>
                    </div>
                    <div class="col-sm-2 col-md-2 col-lg-2 col-xl-2  ">
                      <h6 class="mb-0">₹{{this.product.price}}</h6>
                    </div>
                    <div class="col-sm-2 col-md-2 col-lg-0 col-xl-2 d-sm-none d-lg-block ">
                      <button
                        class="text-center my-2 align-items-end d-flex text-danger btn-none "
                        onclick="removeFromCart('{{this._id}}','{{this.product._id}}')"
                      >Remove</button>
                    </div>
                    <div class="col-sm-1 col-md-1  d-lg-none d-none d-sm-block">
                      <button
                        class="text-center  align-items-end d-flex text-danger btn-none"
                        
                      >X</button>
                    </div>
                    
                  </div>
                  <hr class="my-4" />
                {{/each}}

                <div class="pt-5">
                  <h6 class="mb-0"><a href="/" class="text-body"><i
                        class="fas fa-long-arrow-alt-left me-2"
                      ></i>Back to shop</a></h6>
                </div>
              </div>
            </div>

            <div class="col-lg-3 col-sm-12 col-12 p-4 mt-5 border border-1" style="height: 500px;">
        <h3 class="mb-4">Order Summary</h3>
        <div class="d-flex justify-content-between w-100">
          <p>Price</p>
          <p>$499.99</p>
        </div>
        <div class="d-flex justify-content-between w-100">
          <p>Discount</p>
          <p>$49.00</p>
        </div>
        <div class="d-flex justify-content-between w-100">
          <p>Shipping</p>
          <p class="purple">Free</p>
        </div>
        <div class="d-flex justify-content-between w-100">
          <p>Coupon Applied</p>
          <p>$0.00</p>
        </div>
        <hr />
        <div class="d-flex justify-content-between w-100">
          <p class="purple">TOTAL</p>
          <p class="purple">$548.99</p>
        </div>
        <p>Estimated Delivery by <span class="fw-bold">01 Aug 2022</span></p>
        <form action="/address">
          <input type="text" class="form-control" placeholder="Coupon Code" />
          <button class="btn bg_purple text-white w-100 mt-3">
            CONTINUE TO SHIPPING
          </button>
        </form>
      </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function changeQuantity(cartId, productId, userId, count) { let val =
  document.getElementById(productId).value ; val = parseInt(val) ; count =
  Number(count); $.ajax({ url: "/cart/changeQuantity", data: { cart: cartId,
  user: userId, product: productId, count: count }, method: "POST", success:
  function(data) { $("#total").text(data.total) ; val = val + count;
  document.getElementById(productId).value = val; if (val <= 1) {
  //document.getElementById(`${productId}${cartId}`).disabled = true;
  $(`#${productId}${cartId}`).attr("disabled", true); } else {
  $(`#${productId}${cartId}`).attr("disabled", false); } }, error: function(err)
  {} }) } function removeFromCart(cartId, productId) { console.log(cartId,
  productId); $.ajax({ url: "/cart/remove", data: { cart: cartId, product:
  productId, }, method: "POST", success: function(data) {
  window.location.reload(); }, error: function(err) {} }) }
</script>